export soerfc, SoePara

struct SoePara{T} 
    sw::Vector{Tuple{T, T}}
end

# the default 18 terms approach
SoePara() = SoePara{ComplexF64}([
    (4.56160429581067 - 8.10664614462486im, 1.7841998933545696e-7 + 7.343003636293712e-7im),
    (4.56160429581067 + 8.10664614462486im, 1.7841998935002611e-7 - 7.343003636293118e-7im),
    (4.67614751620509 - 6.66817205403247im, -9.556499453539262e-5 - 0.00015001811262319774im),
    (4.67614751620509 + 6.66817205403247im, -9.556499453567014e-5 + 0.00015001811262314695im),
    (4.75706771210077 - 5.46277771275372im, 0.007705869731927555 + 0.002956305642083839im),
    (4.75706771210077 + 5.46277771275372im, 0.007705869731931252 - 0.0029563056420808262im),
    (4.81739468471801 - 4.37139574323745im, -0.13131561540899633 + 0.0581715387810661im),
    (4.81739468471801 + 4.37139574323745im, -0.13131561540901635 - 0.0581715387810941im),
    (4.86201933938979 - 3.34750236244862im, 0.3353050941709935 - 1.1598168978326757im),
    (4.86201933938979 + 3.34750236244862im, 0.3353050941710323 + 1.15981689783286im),
    (4.89345823682377 - 2.3658861273834im, 3.3749677449815447 + 4.418684212942269im),
    (4.89345823682377 + 2.3658861273834im, 3.3749677449817934 - 4.41868421294285im),
    (4.91338156910332 - 1.41021110952036im, -14.965174561023547 + 0.8807329873608107im),
    (4.91338156910332 + 1.41021110952036im, -14.965174561024503 - 0.8807329873602142im),
    (4.92300187934591 - 0.468589313154398im, 11.878606854122312 - 21.3765363724229im),
    (4.92300187934591 + 0.468589313154398im, 11.878606854123603 + 21.376536372422756im),
    (0.0334524767879181 - 0.0245907245253121im, 4.394108031340191e-15 + 6.7735884437017495e-15im),
    (0.0334524767879181 + 0.0245907245253121im, 4.394104404590236e-15 - 6.773593136580561e-15im)
])

function soerfc(x::T1, sw::SoePara{T2}) where{T1<:Real, T2}

    x = T2(x)

    sum = zero(T2)
    for (si, wi) in sw.sw
        sum += wi * exp( - si * x)
    end
    return T1(real(sum))
end