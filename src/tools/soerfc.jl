function soerfc(x::T1, sw::SoePara{T2}) where{T1<:Real, T2}
    sum = zero(T2)
    if x > 0.0
        for (si, wi) in sw.sw
            sum += 2 / sqrt(π) * wi / si * exp( - si * x)
        end
    else
        for (si, wi) in sw.sw
            sum += - 2 / sqrt(π) * wi / si * exp(si * x)
        end
        sum = 2.0 + sum
    end
    return T1(real(sum))
end

function soerf(x::T1, sw::SoePara{T2}) where{T1<:Real, T2}
    return 1.0 - soerfc(x, sw)
end

# for exp(-(αk)^2)
function soexp(x::T1, sw::SoePara{T2}) where{T1<:Real, T2}
    x = abs(x)
    sum = zero(ComplexF64)
    for (s, w) in sw.sw
        sum += w * exp(- s * x)
    end
    return T1(real(sum))
end

# this formula is used to count the formula exp(kz) erfc(k/2α + αz)
function soexp_mul_erfc(z::T, α::T, k::T, soepara::SoePara{T2}) where{T<:Real, T2}
    k = T2(k)
    sum = zero(ComplexF64)
    if z ≥ 0
        for (s, w) in soepara.sw
            sum += α * w * 2 / sqrt(π) / (s * α + k) * exp(-s * α * z)
        end
    else
        for (s, w) in soepara.sw
            sum += α * w * 2 / sqrt(π) * ( 
                - exp(s * α * z) / (s * α - k) 
                + 2.0 * s * α / ((s * α)^2 - k^2) * exp(k * z))
        end
    end
    return T(real(exp(- k^2 / (4 * α^2)) * sum))
end

SoePara4() = SoePara{ComplexF64}([
    (2.48631398597651 - 0.897378323045937im, 0.826249456689224 - 1.78131068518845im),
    (2.48631398597651 + 0.897378323045937im, 0.826249456689224 + 1.78131068518845im),
    (2.40315018095227 - 2.83616068448077im, -0.326515398594273 + 0.111936582560313im),
    (2.40315018095227 + 2.83616068448077im, -0.326515398594273 - 0.111936582560313im)
])

SoePara8() = SoePara{ComplexF64}([
    (3.33815646978136 + 5.05854898587389im, -0.00886007694548523 + 0.0113042091292579im),
    (3.33815646978136 - 5.05854898587389im, -0.00886007694548516 - 0.011304209129258im),
    (3.53279071224249 + 0.653112650324427im, 2.97739506379945 + 6.91132455163189im),
    (3.53279071224249 - 0.653112650324427im, 2.97739506379944 - 6.9113245516319im),
    (3.50499106490061 + 1.98468086946842im, -2.89181556737244 - 1.11452178676621im),
    (3.50499106490061 - 1.98468086946842im, -2.89181556737244 + 1.11452178676621im),
    (3.44496629848779 + 3.40626818209147im, 0.423280530725485 - 0.16080466274867im),
    (3.44496629848779 - 3.40626818209147im, 0.423280530725485 + 0.160804662748669im)
])

# the default 16 terms approach
SoePara() = SoePara{ComplexF64}([
    (4.56160429581067 + 8.10664614462486im, 5.99673832958228e-6 - 1.68666706190233e-6im),
    (4.56160429581067 - 8.10664614462486im, 5.99673832964075e-6 + 1.68666706179742e-6im),
    (4.67614751620509 + 6.66817205403247im, -0.00128256763349392 + 5.69515998682304e-5im),
    (4.67614751620509 - 6.66817205403247im, -0.00128256763349477 - 5.695159986638e-5im),
    (4.75706771210077 + 5.46277771275372im, 0.0467989716657016 + 0.024842808276986im),
    (4.75706771210077 - 5.46277771275372im, 0.0467989716657026 - 0.0248428082770166im),
    (4.81739468471801 + 4.37139574323745im, -0.335267028777594 - 0.757075111679156im),
    (4.81739468471801 - 4.37139574323745im, -0.335267028777571 + 0.757075111679353im),
    (4.86201933938979 + 3.34750236244862im, -1.99598682670183 + 5.9922116425601im),
    (4.86201933938979 - 3.34750236244862im, -1.99598682670221 - 5.99221164256101im),
    (4.89345823682377 + 2.3658861273834im, 23.9009795446709 - 12.0862363354612im),
    (4.89345823682377 - 2.3658861273834im, 23.9009795446732 + 12.0862363354632im),
    (4.91338156910332 + 1.41021110952036im, -64.0632116678656 - 22.5380203666186im),
    (4.91338156910332 - 1.41021110952036im, -64.0632116678705 + 22.5380203666172im),
    (4.92300187934591 + 0.468589313154398im, 42.9479635779022 + 98.1965284307393im),
    (4.92300187934591 - 0.468589313154398im, 42.9479635779079 - 98.1965284307392im),
    (0.0334524767879181 + 0.0245907245253121im, 2.77886417555933e-16 - 1.05052462423441e-16im),
    (0.0334524767879181 - 0.0245907245253121im, 2.77886412307273e-16 + 1.0505268058843e-16im)
])

SoePara16() = SoePara()