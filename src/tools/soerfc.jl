function soerfc(x::T1, sw::SoePara{T2}) where{T1<:Real, T2}
    sum = zero(T2)
    if x > 0.0
        for (si, wi) in sw.sw
            sum += wi * exp( - si * x)
        end
    else
        for (si, wi) in sw.sw
            sum += - wi * exp(si * x)
        end
        sum = 2.0 + sum
    end
    return T1(real(sum))
end

function soerf(x::T1, sw::SoePara{T2}) where{T1<:Real, T2}
    return 1.0 - soerfc(x, sw)
end

# for exp(-(αk)^2)
function soexp(x::T1, sw::SoePara{T2}) where{T1<:Real, T2}
    x = abs(x)
    sum = zero(ComplexF64)
    for (s, w) in sw.sw
        sum += w * s * sqrt(π) / 2 * exp(- s * x)
    end
    return T1(real(sum))
end

# this formula is used to count the formula exp(kz) erfc(k/2α + αz)
function soexp_mul_erfc(z::T, α::T, k::T, soepara::SoePara{T2}) where{T<:Real, T2}
    k = T2(k)
    sum = zero(ComplexF64)
    if z ≥ 0
        for (s, w) in soepara.sw
            sum += α * w * s / (s * α + k) * exp(-s * α * z)
        end
    else
        for (s, w) in soepara.sw
            sum += α * w * s * ( 
                - exp(s * α * z) / (s * α - k) 
                + 2.0 * s * α / ((s * α)^2 - k^2) * exp(k * z))
        end
    end
    return T(real(exp(- k^2 / (4 * α^2)) * sum))
end

SoePara4() = SoePara{ComplexF64}([
    (2.48631398597651 - 0.897378323045937im, 0.5899163058427808 - 0.5955063480991172im),
    (2.48631398597651 + 0.897378323045937im, 0.5899163058427808 + 0.5955063480991172im),
    (2.40315018095227 - 2.83616068448077im, -0.08999439130744331 - 0.05365109832708595im),
    (2.40315018095227 + 2.83616068448077im, -0.08999439130744331 + 0.05365109832708595im)
])

SoePara8() = SoePara{ComplexF64}([
    (3.33815646978136 - 5.05854898587389im, 0.0008480481906380555 - 0.002535992798377023im),
    (3.33815646978136 + 5.05854898587389im, 0.0008480481906380779 + 0.002535992798377022im),
    (3.53279071224249 - 0.653112650324427im, 1.314171678037612 - 1.964535422215052im),
    (3.53279071224249 + 0.653112650324427im, 1.3141716780376096 + 1.9645354222150557im),
    (3.50499106490061 - 1.98468086946842im, -0.858790736728109 - 0.12748174598059356im),
    (3.50499106490061 + 1.98468086946842im, -0.858790736728109 + 0.12748174598059356im),
    (3.44496629848779 - 3.40626818209147im, 0.04377099996440801 + 0.09594996503727929im),
    (3.44496629848779 + 3.40626818209147im, 0.04377099996440817 - 0.09594996503727912im)
])

# the default 16 terms approach
SoePara() = SoePara{ComplexF64}([
    (4.56160429581067 - 8.10664614462486im, 1.7841998933545696e-7 + 7.343003636293712e-7im),
    (4.56160429581067 + 8.10664614462486im, 1.7841998935002611e-7 - 7.343003636293118e-7im),
    (4.67614751620509 - 6.66817205403247im, -9.556499453539262e-5 - 0.00015001811262319774im),
    (4.67614751620509 + 6.66817205403247im, -9.556499453567014e-5 + 0.00015001811262314695im),
    (4.75706771210077 - 5.46277771275372im, 0.007705869731927555 + 0.002956305642083839im),
    (4.75706771210077 + 5.46277771275372im, 0.007705869731931252 - 0.0029563056420808262im),
    (4.81739468471801 - 4.37139574323745im, -0.13131561540899633 + 0.0581715387810661im),
    (4.81739468471801 + 4.37139574323745im, -0.13131561540901635 - 0.0581715387810941im),
    (4.86201933938979 - 3.34750236244862im, 0.3353050941709935 - 1.1598168978326757im),
    (4.86201933938979 + 3.34750236244862im, 0.3353050941710323 + 1.15981689783286im),
    (4.89345823682377 - 2.3658861273834im, 3.3749677449815447 + 4.418684212942269im),
    (4.89345823682377 + 2.3658861273834im, 3.3749677449817934 - 4.41868421294285im),
    (4.91338156910332 - 1.41021110952036im, -14.965174561023547 + 0.8807329873608107im),
    (4.91338156910332 + 1.41021110952036im, -14.965174561024503 - 0.8807329873602142im),
    (4.92300187934591 - 0.468589313154398im, 11.878606854122312 - 21.3765363724229im),
    (4.92300187934591 + 0.468589313154398im, 11.878606854123603 + 21.376536372422756im),
    (0.0334524767879181 - 0.0245907245253121im, 4.394108031340191e-15 + 6.7735884437017495e-15im),
    (0.0334524767879181 + 0.0245907245253121im, 4.394104404590236e-15 - 6.773593136580561e-15im)
])

SoePara16() = SoePara()